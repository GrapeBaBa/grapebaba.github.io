<!doctype html><html lang=en-us><head><title>Where is your blockchain state | Grapebaba's Home</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="DappçŠ¶æ€å»å“ªäº† ğŸ”—ä¸–ç•ŒçŠ¶æ€ ğŸ”—æˆ‘ä»¬çŸ¥é“åŒºå—é“¾æ¯ä¸€ç¬”æ‰§è¡ŒæˆåŠŸçš„äº¤æ˜“ï¼ŒèƒŒåéƒ½å¯¹åº”ç€ä¸–ç•ŒçŠ¶æ€çš„å˜åŒ–ï¼›å¯ä»¥æ˜¯èµ„äº§æ‰€æœ‰æƒçš„å˜æ›´ï¼Œäº¦æˆ–æ˜¯è´¦æˆ·ä½™é¢çš„å˜åŒ–ã€‚"><meta name=generator content="Hugo 0.110.0"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/images/favicon.ico type=image/x-icon><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","281165273grape@gmail.com","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body><nav class=navigation><a href=/><span class=arrow>â†</span>Home</a>
<a href=/posts>Archive</a>
<a href=/tags>Tags</a>
<a href=/about>About</a>
<a class=button href=https://grapebaba.github.io/index.xml>Subscribe</a></nav><main class=main><section id=single><h1 class=title>Where is your blockchain state</h1><div class=tip><time datetime="2023-02-28 10:33:50 +0800 +0800">Feb 28, 2023</time>
<span class=split>Â·</span>
<span>6053 words</span>
<span class=split>Â·</span>
<span>13 minute read</span></div><aside class=toc><details><summary>Table of Contents</summary><div><nav id=TableOfContents><ul><li><a href=#ä¸–ç•ŒçŠ¶æ€>ä¸–ç•ŒçŠ¶æ€</a></li><li><a href=#çŠ¶æ€è¯»å†™æŠ½è±¡>çŠ¶æ€è¯»å†™æŠ½è±¡</a><ul><li><a href=#fabricä¸­çš„çŠ¶æ€è¯»å†™æ¥å£><code>Fabric</code>ä¸­çš„çŠ¶æ€è¯»å†™æ¥å£</a></li><li><a href=#solidityä¸­çš„çŠ¶æ€å˜é‡><code>Solidity</code>ä¸­çš„çŠ¶æ€å˜é‡</a></li></ul></li><li><a href=#çŠ¶æ€æ•°æ®åº“>çŠ¶æ€æ•°æ®åº“</a><ul><li><a href=#fabricæ•°æ®åº“ä¸­çš„keyå’Œvalue><code>Fabric</code>æ•°æ®åº“ä¸­çš„<code>KEY</code>å’Œ<code>VALUE</code></a></li><li><a href=#go-ethereumæ•°æ®åº“ä¸­çš„keyå’Œvalue><code>Go-ethereum</code>æ•°æ®åº“ä¸­çš„<code>KEY</code>å’Œ<code>VALUE</code></a></li></ul></li><li><a href=#å†…å­˜ä¸­çš„çŠ¶æ€>å†…å­˜ä¸­çš„çŠ¶æ€</a><ul><li><a href=#å…¨å±€ç¼“å­˜>å…¨å±€ç¼“å­˜</a></li><li><a href=#åŒºå—æ‰§è¡Œæ—¶çš„çŠ¶æ€>åŒºå—æ‰§è¡Œæ—¶çš„çŠ¶æ€</a></li></ul></li><li><a href=#ç»“è¯­>ç»“è¯­</a></li></ul></nav></div></details></aside><div class=content><h1 id=dappçŠ¶æ€å»å“ªäº†><code>Dapp</code>çŠ¶æ€å»å“ªäº† <a href=#dapp%e7%8a%b6%e6%80%81%e5%8e%bb%e5%93%aa%e4%ba%86 class=anchor>ğŸ”—</a></h1><h2 id=ä¸–ç•ŒçŠ¶æ€>ä¸–ç•ŒçŠ¶æ€ <a href=#%e4%b8%96%e7%95%8c%e7%8a%b6%e6%80%81 class=anchor>ğŸ”—</a></h2><p>æˆ‘ä»¬çŸ¥é“åŒºå—é“¾æ¯ä¸€ç¬”æ‰§è¡ŒæˆåŠŸçš„äº¤æ˜“ï¼ŒèƒŒåéƒ½å¯¹åº”ç€ä¸–ç•ŒçŠ¶æ€çš„å˜åŒ–ï¼›å¯ä»¥æ˜¯èµ„äº§æ‰€æœ‰æƒçš„å˜æ›´ï¼Œäº¦æˆ–æ˜¯è´¦æˆ·ä½™é¢çš„å˜åŒ–ã€‚ä½œä¸º<code>dapp</code>å¼€å‘äººå‘˜ï¼Œä½ å¯èƒ½åªå…³å¿ƒè‡ªå·±åˆçº¦çš„çŠ¶æ€ï¼Œè€Œæ•´ä¸ªåŒºå—é“¾æ˜¯å¦‚ä½•ç»„ç»‡å’Œå­˜å‚¨ä¸–ç•ŒçŠ¶æ€çš„å‘¢ï¼Ÿ</p><h2 id=çŠ¶æ€è¯»å†™æŠ½è±¡>çŠ¶æ€è¯»å†™æŠ½è±¡ <a href=#%e7%8a%b6%e6%80%81%e8%af%bb%e5%86%99%e6%8a%bd%e8%b1%a1 class=anchor>ğŸ”—</a></h2><p>å¦‚æœå†™è¿‡æ™ºèƒ½åˆçº¦ï¼Œæˆ‘ä»¬ä¼šå‘ç°ç»å¤§å¤šæ•°çš„åŒºå—é“¾åº•å±‚éƒ½æä¾›äº†æœ€åŸºç¡€çš„<code>KV</code>å­˜å‚¨æ¨¡å‹ã€‚</p><h3 id=fabricä¸­çš„çŠ¶æ€è¯»å†™æ¥å£><code>Fabric</code>ä¸­çš„çŠ¶æ€è¯»å†™æ¥å£ <a href=#fabric%e4%b8%ad%e7%9a%84%e7%8a%b6%e6%80%81%e8%af%bb%e5%86%99%e6%8e%a5%e5%8f%a3 class=anchor>ğŸ”—</a></h3><p>å¦‚æœä½ å¼€å‘è¿‡<code>Fabric</code>çš„<code>chaincode</code>ï¼Œä½ è‚¯å®šä½¿ç”¨è¿‡ä¸‹é¢çš„æ¥å£ã€‚éå¸¸æ˜ç¡®çš„å°†çŠ¶æ€è¯»å†™æ¥å£æš´éœ²ç»™<code>chaincode</code>å¼€å‘äººå‘˜ã€‚</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:#666>//</span><span style=color:#bbb> </span>GetState<span style=color:#bbb> </span>returns<span style=color:#bbb> </span>the<span style=color:#bbb> </span>value<span style=color:#bbb> </span>of<span style=color:#bbb> </span>the<span style=color:#bbb> </span>specified<span style=color:#bbb> </span><span style=color:#666>`</span><span style=color:#a2f;font-weight:700>key</span><span style=color:#666>`</span><span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>from</span><span style=color:#bbb> </span>the<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:#666>//</span><span style=color:#bbb> </span>ledger.<span style=color:#bbb> </span>Note<span style=color:#bbb> </span>that<span style=color:#bbb> </span>GetState<span style=color:#bbb> </span>doesn<span style=color:#b44>&#39;t read data from the writeset, which
</span></span></span><span style=display:flex><span><span style=color:#b44>	// has not been committed to the ledger. In other words, GetState doesn&#39;</span>t<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:#666>//</span><span style=color:#bbb> </span>consider<span style=color:#bbb> </span>data<span style=color:#bbb> </span>modified<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>by</span><span style=color:#bbb> </span>PutState<span style=color:#bbb> </span>that<span style=color:#bbb> </span>has<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>not</span><span style=color:#bbb> </span>been<span style=color:#bbb> </span>committed.<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:#666>//</span><span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>If</span><span style=color:#bbb> </span>the<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>key</span><span style=color:#bbb> </span>does<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>not</span><span style=color:#bbb> </span>exist<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>in</span><span style=color:#bbb> </span>the<span style=color:#bbb> </span>state<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>database</span>,<span style=color:#bbb> </span>(nil,<span style=color:#bbb> </span>nil)<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>is</span><span style=color:#bbb> </span>returned.<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:#00a000>GetState</span>(<span style=color:#a2f;font-weight:700>key</span><span style=color:#bbb> </span>string)<span style=color:#bbb> </span>([]byte,<span style=color:#bbb> </span>error)<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:#666>//</span><span style=color:#bbb> </span>PutState<span style=color:#bbb> </span>puts<span style=color:#bbb> </span>the<span style=color:#bbb> </span>specified<span style=color:#bbb> </span><span style=color:#666>`</span><span style=color:#a2f;font-weight:700>key</span><span style=color:#666>`</span><span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>and</span><span style=color:#bbb> </span><span style=color:#666>`</span>value<span style=color:#666>`</span><span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>into</span><span style=color:#bbb> </span>the<span style=color:#bbb> </span>transaction<span style=color:#b44>&#39;s
</span></span></span><span style=display:flex><span><span style=color:#b44>	// writeset as a data-write proposal. PutState doesn&#39;</span>t<span style=color:#bbb> </span>effect<span style=color:#bbb> </span>the<span style=color:#bbb> </span>ledger<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:#666>//</span><span style=color:#bbb> </span>until<span style=color:#bbb> </span>the<span style=color:#bbb> </span>transaction<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>is</span><span style=color:#bbb> </span>validated<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>and</span><span style=color:#bbb> </span>successfully<span style=color:#bbb> </span>committed.<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:#666>//</span><span style=color:#bbb> </span>Simple<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>keys</span><span style=color:#bbb> </span>must<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>not</span><span style=color:#bbb> </span>be<span style=color:#bbb> </span>an<span style=color:#bbb> </span>empty<span style=color:#bbb> </span>string<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>and</span><span style=color:#bbb> </span>must<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>not</span><span style=color:#bbb> </span>start<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>with</span><span style=color:#bbb> </span>a<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:#666>//</span><span style=color:#bbb> </span><span style=color:#800>null</span><span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>character</span><span style=color:#bbb> </span>(<span style=color:#666>0</span>x00)<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>in</span><span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>order</span><span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>to</span><span style=color:#bbb> </span>avoid<span style=color:#bbb> </span>range<span style=color:#bbb> </span>query<span style=color:#bbb> </span>collisions<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>with</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:#666>//</span><span style=color:#bbb> </span>composite<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>keys</span>,<span style=color:#bbb> </span>which<span style=color:#bbb> </span>internally<span style=color:#bbb> </span>get<span style=color:#bbb> </span>prefixed<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>with</span><span style=color:#bbb> </span><span style=color:#666>0</span>x00<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>as</span><span style=color:#bbb> </span>composite<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:#666>//</span><span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>key</span><span style=color:#bbb> </span>namespace.<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>In</span><span style=color:#bbb> </span>addition,<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>if</span><span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>using</span><span style=color:#bbb> </span>CouchDB,<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>keys</span><span style=color:#bbb> </span>can<span style=color:#bbb> </span>only<span style=color:#bbb> </span>contain<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:#666>//</span><span style=color:#bbb> </span>valid<span style=color:#bbb> </span>UTF<span style=color:#666>-</span><span style=color:#666>8</span><span style=color:#bbb> </span>strings<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>and</span><span style=color:#bbb> </span>cannot<span style=color:#bbb> </span>begin<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>with</span><span style=color:#bbb> </span>an<span style=color:#bbb> </span><span style=color:#00a000>underscore</span><span style=color:#bbb> </span>(<span style=color:#b44>&#34;_&#34;</span>).<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:#00a000>PutState</span>(<span style=color:#a2f;font-weight:700>key</span><span style=color:#bbb> </span>string,<span style=color:#bbb> </span>value<span style=color:#bbb> </span>[]byte)<span style=color:#bbb> </span>error<span style=color:#bbb>
</span></span></span></code></pre></div><p>æŸ¥çœ‹åº•å±‚å¤„ç†çŠ¶æ€è¯»å†™çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åº•å±‚çš„å­˜å‚¨æ¥å£å¢åŠ äº†<code>namespace</code>çš„å‰ç¼€ï¼Œè¿™ä¸ª<code>namespace</code>å®é™…ä¸Šå¯¹åº”çš„æ˜¯<code>chaincodeID</code>ã€‚</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>func (q *queryExecutor) getState(ns, key string) ([]byte, []byte, error) {
</span></span><span style=display:flex><span>	if err := q.checkDone(); err != nil {
</span></span><span style=display:flex><span>		return nil, nil, err
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	versionedValue, err := q.txmgr.db.GetState(ns, key)
</span></span><span style=display:flex><span>	if err != nil {
</span></span><span style=display:flex><span>		return nil, nil, err
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	val, metadata, ver := decomposeVersionedValue(versionedValue)
</span></span><span style=display:flex><span>	if q.collectReadset {
</span></span><span style=display:flex><span>		q.rwsetBuilder.AddToReadSet(ns, key, ver)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	return val, metadata, nil
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>// SetState implements method in interface `ledger.TxSimulator`
</span></span><span style=display:flex><span>func (s *txSimulator) SetState(ns string, key string, value []byte) error {
</span></span><span style=display:flex><span>	if err := s.checkWritePrecondition(key, value); err != nil {
</span></span><span style=display:flex><span>		return err
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	s.rwsetBuilder.AddToWriteSet(ns, key, value)
</span></span><span style=display:flex><span>	return nil
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=solidityä¸­çš„çŠ¶æ€å˜é‡><code>Solidity</code>ä¸­çš„çŠ¶æ€å˜é‡ <a href=#solidity%e4%b8%ad%e7%9a%84%e7%8a%b6%e6%80%81%e5%8f%98%e9%87%8f class=anchor>ğŸ”—</a></h3><p>è€Œä½ å¦‚æœä½¿ç”¨<code>Solidity</code>ç¼–å†™è¿‡æ™ºèƒ½åˆçº¦ï¼Œä½ å¯èƒ½ä¼šå‘ç°å¹¶æ²¡æœ‰æ˜ç¡®çš„çŠ¶æ€è¯»å†™æ¥å£ï¼Œä½†æ˜¯ä½ ä¸€å®šä¼šç”¨åˆ°<code>State Variables</code>ã€‚çŠ¶æ€å˜é‡çš„è¯»å†™åœ¨<code>EVM</code>çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šå¯¹åº”åˆ°æŒ‡ä»¤ç <code>SLOAD</code>å’Œ<code>SSTORE</code>ã€‚</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>contract ExampleContract { 
</span></span><span style=display:flex><span>    uint storedData; // State variable
</span></span><span style=display:flex><span>    event Sent ( msg ); 
</span></span><span style=display:flex><span>    constructor () public {}
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    function method ( uint x) public { 
</span></span><span style=display:flex><span>        storeData = x;
</span></span><span style=display:flex><span>        emit Sent (&#39;Success&#39;);
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>æŸ¥çœ‹<code>hyperledger/burrow</code>é¡¹ç›®å®ç°çš„<code>EVM</code>ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®é™…åº•å±‚ä¹Ÿæ˜¯ç±»ä¼¼çš„<code>KV</code>å­˜å‚¨ã€‚åŒæ ·çš„æˆ‘ä»¬å‘ç°åœ¨åº•å±‚å­˜å‚¨ä¸­å¢åŠ äº†<code>params.Callee</code>è¿™æ ·ä¸€ä¸ªç±»ä¼¼çš„<code>namespace</code>ï¼Œè¿™é‡Œå¯¹åº”çš„å…¶å®æ˜¯åˆçº¦è´¦æˆ·åœ°å€ã€‚</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>case SLOAD: // 0x54
</span></span><span style=display:flex><span>    loc := stack.Pop()
</span></span><span style=display:flex><span>    data := LeftPadWord256(maybe.Bytes(st.CallFrame.GetStorage(params.Callee, loc)))
</span></span><span style=display:flex><span>    stack.Push(data)
</span></span><span style=display:flex><span>    c.debugf(&#34;%v {0x%v = 0x%v}\n&#34;, params.Callee, loc, data)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>case SSTORE: // 0x55
</span></span><span style=display:flex><span>    loc, data := stack.Pop(), stack.Pop()
</span></span><span style=display:flex><span>    maybe.PushError(engine.UseGasNegative(params.Gas, engine.GasStorageUpdate))
</span></span><span style=display:flex><span>	maybe.PushError(st.CallFrame.SetStorage(params.Callee, loc, data.Bytes()))
</span></span><span style=display:flex><span>    c.debugf(&#34;%v {%v := %v}\n&#34;, params.Callee, loc, data)
</span></span></code></pre></div><h2 id=çŠ¶æ€æ•°æ®åº“>çŠ¶æ€æ•°æ®åº“ <a href=#%e7%8a%b6%e6%80%81%e6%95%b0%e6%8d%ae%e5%ba%93 class=anchor>ğŸ”—</a></h2><p>å‰é¢æˆ‘ä»¬å·²ç»çŸ¥é“äº†åˆçº¦ä¸­çš„çŠ¶æ€è¯»å†™æ¥å£æ˜¯æ€ä¹ˆå’ŒåŒºå—é“¾åº•å±‚å…³è”çš„ï¼Œä½†æ˜¯çŠ¶æ€åˆæ˜¯å¦‚ä½•æŒä¹…åŒ–åˆ°çŠ¶æ€æ•°æ®åº“ä¸­çš„å‘¢ï¼Ÿç»å¤§éƒ¨åˆ†çš„åŒºå—é“¾éƒ½æ˜¯ä½¿ç”¨çš„<code>KV</code>æ•°æ®åº“æ¥ä½œä¸ºçŠ¶æ€æ•°æ®åº“ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›åŒºå—é“¾æ”¯æŒå…³ç³»æ•°æ®åº“å’Œæ–‡æ¡£æ•°æ®åº“ç­‰ã€‚</p><p>æˆ‘ä»¬è¿™é‡Œåªä»‹ç»<code>KV</code>çŠ¶æ€æ•°æ®åº“ï¼Œä¸‹é¢ä»¥<code>Fabric</code>å’Œ<code>Go-ethereum</code>ä¸ºä¾‹å­æ¥çœ‹çœ‹å®ƒä»¬æ˜¯å¦‚ä½•å¤„ç†çš„ã€‚å› ä¸º<code>KV</code>æ˜¯éå¸¸ç®€å•çš„æ¨¡å‹ï¼Œæˆ‘ä»¬åªè¦ææ¸…æ¥š<code>KEY</code>å’Œ<code>VALUE</code>æ˜¯å¦‚ä½•ç¼–è§£ç çš„ï¼Œæˆ‘ä»¬å°±èƒ½ç†è§£æ•´ä¸ªåŒºå—é“¾ä¸­çš„çŠ¶æ€ç®¡ç†ã€‚</p><h3 id=fabricæ•°æ®åº“ä¸­çš„keyå’Œvalue><code>Fabric</code>æ•°æ®åº“ä¸­çš„<code>KEY</code>å’Œ<code>VALUE</code> <a href=#fabric%e6%95%b0%e6%8d%ae%e5%ba%93%e4%b8%ad%e7%9a%84key%e5%92%8cvalue class=anchor>ğŸ”—</a></h3><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“<code>Fabric</code>ä¸­æœ‰<code>channel</code>å’Œ<code>chaincode</code>çš„æ¦‚å¿µï¼Œæ¯ä¸€ä¸ª<code>channel</code>å¯¹åº”äºä¸€æ¡ç‹¬ç«‹çš„åŒºå—é“¾ï¼Œæ¯ä¸€ä¸ª<code>chaincode</code>å¯¹åº”äºä¸€ä¸ªç‹¬ç«‹çš„æ™ºèƒ½åˆçº¦ã€‚åœ¨å†…å­˜ä¸­<code>Fabric</code>ä¼šä½¿ç”¨å¤šçº§<code>Map</code>çš„æ•°æ®ç»“æ„æ¥ç»„ç»‡æ•´ä¸ªçŠ¶æ€æ•°æ®ï¼Œè€Œå…¶å®åº•å±‚åªä½¿ç”¨ä¸€ä¸ª<code>KV</code>æ•°æ®åº“ä½œä¸ºçŠ¶æ€æ•°æ®åº“ã€‚</p><p>å…¶ä¸­<code>KEY</code>çš„ç¼–ç æ˜¯å°†å†…å­˜ä¸­çš„å±‚çº§ç»“æ„é“ºå¹³ï¼Œç”±<code>channelID</code>ï¼Œ<code>chaincodeID</code>å’Œç”¨æˆ·è‡ªå·±å®šä¹‰çš„<code>key</code>æ‹¼æ¥è€Œæˆã€‚</p><blockquote><p>channelID + chaincodeID + user_defined_key</p></blockquote><p>è€Œ<code>VALUE</code>çš„ç¼–ç åˆ™æ˜¯å’Œ<code>RWSet</code>ç´§å¯†ç›¸å…³ï¼Œå¯é€šè¿‡å®˜æ–¹æ–‡æ¡£<a href=https://hyperledger-fabric.readthedocs.io/en/latest/readwrite.html target=_blank rel=noopener>Read-Write set semantics</a>ç« èŠ‚äº†è§£<code>RWSet</code>çš„æ¦‚å¿µã€‚</p><p>æ ¹æ®ä¸‹é¢çš„<code>proto</code>æ•°æ®ç»“æ„å®šä¹‰ï¼Œå¯ä»¥çœ‹å‡ºå®é™…æ•°æ®åº“ä¸­çš„<code>VALUE</code>é™¤äº†åŒ…å«ç”¨æˆ·è‡ªå®šä¹‰çš„<code>Value</code>ï¼Œè¿˜åŒ…æ‹¬äº†<code>Version</code>å’Œ<code>Metadata</code>ä¸¤ä¸ªé™„åŠ çš„å€¼ï¼Œè€Œ<code>Version</code>çš„å€¼å®é™…ä¸Šæ˜¯<code>Height</code>ç¼–ç åçš„å†…å®¹ã€‚</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>type DBValue struct {
</span></span><span style=display:flex><span>	Version              []byte   `protobuf:&#34;bytes,1,opt,name=version,proto3&#34; json:&#34;version,omitempty&#34;`
</span></span><span style=display:flex><span>	Value                []byte   `protobuf:&#34;bytes,2,opt,name=value,proto3&#34; json:&#34;value,omitempty&#34;`
</span></span><span style=display:flex><span>	Metadata             []byte   `protobuf:&#34;bytes,3,opt,name=metadata,proto3&#34; json:&#34;metadata,omitempty&#34;`
</span></span><span style=display:flex><span>	XXX_NoUnkeyedLiteral struct{} `json:&#34;-&#34;`
</span></span><span style=display:flex><span>	XXX_unrecognized     []byte   `json:&#34;-&#34;`
</span></span><span style=display:flex><span>	XXX_sizecache        int32    `json:&#34;-&#34;`
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>type Height struct {
</span></span><span style=display:flex><span>	BlockNum uint64
</span></span><span style=display:flex><span>	TxNum    uint64
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=go-ethereumæ•°æ®åº“ä¸­çš„keyå’Œvalue><code>Go-ethereum</code>æ•°æ®åº“ä¸­çš„<code>KEY</code>å’Œ<code>VALUE</code> <a href=#go-ethereum%e6%95%b0%e6%8d%ae%e5%ba%93%e4%b8%ad%e7%9a%84key%e5%92%8cvalue class=anchor>ğŸ”—</a></h3><p>å¦‚æœç¨å¾®äº†è§£è¿‡<code>Ethereum</code>ï¼Œåº”è¯¥çŸ¥é“<code>Ethereum</code>ä¸­æœ‰ä¸€ä¸ªç‰¹åˆ«çš„æ•°æ®ç»“æ„<a href=https://ethereum.org/en/developers/docs/data-structures-and-encoding/patricia-merkle-trie/ target=_blank rel=noopener>PATRICIA MERKLE TREES</a>ã€‚<code>MPT</code>å®é™…è¢«åº”ç”¨åˆ°å¤šä¸ªæ¨¡å—ï¼Œè€Œå’ŒçŠ¶æ€å¯†åˆ‡ç›¸å…³çš„ï¼Œä¸»è¦æ˜¯<code>World State Trie</code>å’Œ<code>Storage Trie</code>ã€‚</p><p>è™½ç„¶<code>PATRICIA MERKLE TREES</code>æœ‰<code>Branch node</code>ï¼Œ<code>Extension node</code>å’Œ<code>Leaf node</code>ç­‰å¤šç§ç±»å‹(ä¸è®¨è®º<code>NULL</code>èŠ‚ç‚¹)ï¼›åŒæ—¶åœ¨<code>Ethereum</code>ä¸­æ¯ä¸€ä¸ª<code>Address</code>éƒ½å¯¹åº”äº†ä¸€æ£µ<code>World State Trie</code>ï¼Œå¹¶ä¸”å¦‚æœ<code>Address</code>æ˜¯ä¸€ä¸ªåˆçº¦åœ°å€ï¼Œè¿˜åŒæ—¶å¯¹åº”äº†ä¸€æ£µ<code>Storage Trie</code>ã€‚ä½†æ˜¯å¯¹äºçŠ¶æ€æ•°æ®åº“ä¸­çš„<code>KEY</code>å’Œ<code>VALUE</code>ç¼–ç ï¼Œå®é™…ä¸Šå¯ä»¥åªç”¨ä¸€æ¡ç»Ÿä¸€çš„è§„åˆ™æè¿°ã€‚</p><blockquote><p>ğ‘˜ğ‘’ğ‘ğ‘ğ‘ğ‘˜ (ğ‘…ğ¿ğ‘ƒ (ğ‘›ğ‘œğ‘‘ğ‘’)) â†’ ğ‘…ğ¿ğ‘ƒ (ğ‘›ğ‘œğ‘‘ğ‘’)</p></blockquote><p><code>ğ‘˜ğ‘’ğ‘ğ‘ğ‘ğ‘˜</code>æ˜¯<code>Ethereum</code>ä½¿ç”¨çš„<code>hash</code>ç®—æ³•ï¼Œè€Œ<a href=https://ethereum.org/en/developers/docs/data-structures-and-encoding/rlp/ target=_blank rel=noopener>ğ‘…ğ¿ğ‘ƒ</a>æ˜¯<code>Ethereum</code>ä½¿ç”¨çš„ç¼–è§£ç æ ¼å¼ã€‚</p><ul><li>Extension ğ‘›ğ‘œğ‘‘ğ‘’ â‰¡ [ğ»ğ‘ƒ (ğ‘ğ‘Ÿğ‘’ğ‘“ğ‘–ğ‘¥ + ğ‘ğ‘ğ‘¡â„), ğ‘˜ğ‘’ğ‘¦]</li><li>Branch ğ‘›ğ‘œğ‘‘ğ‘’ â‰¡ [ğ‘ğ‘Ÿğ‘ğ‘›ğ‘â„ğ‘’ğ‘ , ğ‘£ğ‘ğ‘™ğ‘¢ğ‘’]</li><li>Leaf ğ‘›ğ‘œğ‘‘ğ‘’ â‰¡ [ğ»ğ‘ƒ (ğ‘ğ‘Ÿğ‘’ğ‘“ğ‘–ğ‘¥ + ğ‘ğ‘ğ‘¡â„), ğ‘£ğ‘ğ‘™ğ‘¢ğ‘’]</li></ul><p><code>ğ»ğ‘ƒ</code>ä»£è¡¨çš„æ˜¯<code>Hex Prefix Encoding</code>ï¼Œ<code>ğ‘ğ‘Ÿğ‘’ğ‘“ğ‘–ğ‘¥</code>æŒ‡çš„æ˜¯ç”¨äºåŒºåˆ†ä¸åŒçš„<code>Extension</code>å’Œ<code>Leaf</code>çš„<code>node</code>çš„æ ‡å¿—ä½ã€‚</p><p>ä»ä¸Šè¿°çš„è§„åˆ™æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>Ethereum</code>çš„çŠ¶æ€æ•°æ®åº“æ˜¯æŠŠæ‰€æœ‰<code>MPT</code>çš„èŠ‚ç‚¹è¿›è¡Œäº†å­˜å‚¨ï¼Œè€Œå¯¹åº”<code>KEY</code>æ˜¯èŠ‚ç‚¹ç¼–ç åçš„<code>hash</code>å€¼ï¼Œè€Œ<code>VALUE</code>å°±æ˜¯èŠ‚ç‚¹ç¼–ç çš„å®é™…å€¼ã€‚</p><h2 id=å†…å­˜ä¸­çš„çŠ¶æ€>å†…å­˜ä¸­çš„çŠ¶æ€ <a href=#%e5%86%85%e5%ad%98%e4%b8%ad%e7%9a%84%e7%8a%b6%e6%80%81 class=anchor>ğŸ”—</a></h2><p>å‰é¢æˆ‘ä»¬è¯´åˆ°äº†é¢å‘ç”¨æˆ·çš„çŠ¶æ€è¯»å†™æŠ½è±¡å’ŒçŠ¶æ€æ˜¯å¦‚ä½•è¢«æŒä¹…åŒ–åˆ°æ•°æ®åº“ä¸­çš„ï¼Œä¸‹é¢æˆ‘ä»¬æ¥è¯´ä¸€è¯´ä½äºä¸¤è€…ä¸­é—´çš„å†…å­˜ä¸­çš„çŠ¶æ€ã€‚</p><h3 id=å…¨å±€ç¼“å­˜>å…¨å±€ç¼“å­˜ <a href=#%e5%85%a8%e5%b1%80%e7%bc%93%e5%ad%98 class=anchor>ğŸ”—</a></h3><p>ç±»ä¼¼æ“ä½œç³»ç»Ÿæˆ–è€…æ•°æ®åº“ç³»ç»Ÿï¼Œä¸ºäº†æå‡æ•ˆç‡ï¼ŒåŒºå—é“¾ä¼šå°†çŠ¶æ€æ•°æ®åº“ä¸­çš„æ•°æ®åœ¨å†…å­˜ä¸­è¿›è¡Œç¼“å­˜ã€‚å…¨å±€çš„ç¼“å­˜é€šå¸¸æ˜¯ä¸€ä¸ªæœ‰åº<code>Map</code>çš„æ•°æ®ç»“æ„ï¼Œç¼“å­˜çš„å†…å®¹å®é™…å°±æ˜¯æ•°æ®åº“ä¸­çš„<code>KEY</code>å’Œ<code>VALUE</code>ã€‚</p><h3 id=åŒºå—æ‰§è¡Œæ—¶çš„çŠ¶æ€>åŒºå—æ‰§è¡Œæ—¶çš„çŠ¶æ€ <a href=#%e5%8c%ba%e5%9d%97%e6%89%a7%e8%a1%8c%e6%97%b6%e7%9a%84%e7%8a%b6%e6%80%81 class=anchor>ğŸ”—</a></h3><p>åŒºå—çš„æ‰§è¡Œå®é™…å°±æ˜¯æ‰§è¡Œè¯¥åŒºå—ä¸­çš„å…¨éƒ¨äº¤æ˜“ï¼Œäº¤æ˜“åœ¨æ‰§è¡Œæ—¶éƒ½æ˜¯ä»å½“å‰æœ€æ–°çš„ä¸–ç•ŒçŠ¶æ€ä¸­å»è¯»å–æ•°æ®ï¼Œè€Œå°†å¯¹çŠ¶æ€çš„å˜æ›´å…ˆæ›´æ–°åˆ°å½“å‰æ‰§è¡Œä¸Šä¸‹æ–‡çš„å†…å­˜æ•°æ®ç»“æ„ä¸­ï¼›å½“å…¨éƒ¨äº¤æ˜“æ‰§è¡Œå®Œæˆåï¼Œå°†å½“å‰ä¸Šä¸‹æ–‡ä¸­å˜æ›´äº†çš„çŠ¶æ€æ•´ä¸ªæäº¤åˆ°çŠ¶æ€æ•°æ®åº“å’Œå…¨å±€ç¼“å­˜ä¸­ã€‚ä¸‹é¢æˆ‘ä»¬è¿˜æ˜¯ä»¥<code>Fabric</code>å’Œ<code>Go-ethereum</code>ä¸ºä¾‹å­æ¥çœ‹çœ‹å®ƒä»¬åˆ†åˆ«æ˜¯æ€ä¹ˆå¤„ç†çš„ã€‚</p><h4 id=fabricå†…å­˜ä¸­çš„çŠ¶æ€è¡¨ç¤º><code>Fabric</code>å†…å­˜ä¸­çš„çŠ¶æ€è¡¨ç¤º <a href=#fabric%e5%86%85%e5%ad%98%e4%b8%ad%e7%9a%84%e7%8a%b6%e6%80%81%e8%a1%a8%e7%a4%ba class=anchor>ğŸ”—</a></h4><p><code>Fabric</code>çš„æ•´ä½“æ‰§è¡Œæµç¨‹æ˜¯<code>Execute</code>-><code>Orderer</code>-><code>Validate</code>æ–¹å¼ï¼Œå› æ­¤å®ƒçš„äº¤æ˜“å†…å®¹ä¸­çš„<code>RWSet</code>ï¼Œå®é™…ä¸Šæ˜¯è¯¥äº¤æ˜“æ‰§è¡Œæ—¶è¯»å†™è¿‡çš„çŠ¶æ€ï¼Œæ¯ç¬”äº¤æ˜“æ‰§è¡Œæ—¶è¯»å–çš„çŠ¶æ€éƒ½æ˜¯ä»¥ä¸Šä¸€ä¸ªåŒºå—æäº¤åçš„ä¸–ç•ŒçŠ¶æ€ä¸ºåŸºå‡†ï¼Œå†™å…¥çš„çŠ¶æ€åˆ™å†™å…¥åˆ°å½“å‰äº¤æ˜“ä¸Šä¸‹æ–‡çš„<code>WSet</code>ä¸­ã€‚å› ä¸ºæ‰€æœ‰äº¤æ˜“çš„è¯»å–éƒ½æ˜¯ä»¥ä¸Šä¸€ä¸ªåŒºå—æäº¤åçš„ä¸–ç•ŒçŠ¶æ€ä¸ºåŸºå‡†ï¼Œæ‰€ä»¥å¯èƒ½å­˜åœ¨çŠ¶æ€æ›´æ–°å†²çªçš„äº¤æ˜“ï¼ˆè¿˜æ˜¯å‚è€ƒ<a href=https://hyperledger-fabric.readthedocs.io/en/latest/readwrite.html target=_blank rel=noopener>Read-Write set semantics</a>ï¼‰ï¼Œåœ¨<code>Validate</code>é˜¶æ®µè¿›è¡Œ<code>MVCC</code>éªŒè¯è¿‡ç¨‹ä¸­ï¼Œä¼šä¿è¯å†²çªçš„äº¤æ˜“åªæœ‰ä¸€ç¬”èƒ½å¤ŸæˆåŠŸã€‚è€ŒéªŒè¯å®Œåçš„ç»“æœå®é™…ä¸Šå°±å¾—åˆ°äº†ä¸€ä¸ª<code>Batch</code>å¯¹è±¡ï¼Œä¿å­˜äº†æ‰€æœ‰æˆåŠŸäº¤æ˜“å˜æ›´è¿‡çš„çŠ¶æ€çš„é›†åˆã€‚</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#666>//</span><span style=color:#bbb> </span>UpdateBatch<span style=color:#bbb> </span>encapsulates<span style=color:#bbb> </span>the<span style=color:#bbb> </span>updates<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>to</span><span style=color:#bbb> </span>Public,<span style=color:#bbb> </span>Private,<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>and</span><span style=color:#bbb> </span>Hashed<span style=color:#bbb> </span>data.<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>//</span><span style=color:#bbb> </span>This<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>is</span><span style=color:#bbb> </span>expected<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>to</span><span style=color:#bbb> </span>contain<span style=color:#bbb> </span>a<span style=color:#bbb> </span>consistent<span style=color:#bbb> </span><span style=color:#0b0;font-weight:700>set</span><span style=color:#bbb> </span>of<span style=color:#bbb> </span>updates<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>type<span style=color:#bbb> </span>UpdateBatch<span style=color:#bbb> </span>struct<span style=color:#bbb> </span><span>{</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>PubUpdates<span style=color:#bbb>  </span><span style=color:#666>*</span>PubUpdateBatch<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>HashUpdates<span style=color:#bbb> </span><span style=color:#666>*</span>HashedUpdateBatch<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>PvtUpdates<span style=color:#bbb>  </span><span style=color:#666>*</span>PvtUpdateBatch<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span>}</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>//</span><span style=color:#bbb> </span>PubUpdateBatch<span style=color:#bbb> </span>contains<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>update</span><span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>for</span><span style=color:#bbb> </span>the<span style=color:#bbb> </span>public<span style=color:#bbb> </span>data<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>type<span style=color:#bbb> </span>PubUpdateBatch<span style=color:#bbb> </span>struct<span style=color:#bbb> </span><span>{</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:#666>*</span>statedb.UpdateBatch<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span>}</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>//</span><span style=color:#bbb> </span>UpdateBatch<span style=color:#bbb> </span>encloses<span style=color:#bbb> </span>the<span style=color:#bbb> </span>details<span style=color:#bbb> </span>of<span style=color:#bbb> </span>multiple<span style=color:#bbb> </span><span style=color:#666>`</span>updates<span style=color:#666>`</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>type<span style=color:#bbb> </span>UpdateBatch<span style=color:#bbb> </span>struct<span style=color:#bbb> </span><span>{</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>ContainsPostOrderWrites<span style=color:#bbb> </span><span style=color:#0b0;font-weight:700>bool</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>Updates<span style=color:#bbb>                 </span>map[string]<span style=color:#666>*</span>nsUpdates<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span>}</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>type<span style=color:#bbb> </span>nsUpdates<span style=color:#bbb> </span>struct<span style=color:#bbb> </span><span>{</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>M<span style=color:#bbb> </span>map[string]<span style=color:#666>*</span>VersionedValue<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span>}</span><span style=color:#bbb>
</span></span></span></code></pre></div><p>è¿™é‡Œæˆ‘ä»¬ä¸è®²<code>HashedUpdateBatch</code>å’Œ<code>PvtUpdates</code>(ä¸å…¶å†…éƒ¨å…¶ä»–ç‰¹æ€§æœ‰å…³)ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>PubUpdates</code>å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªä¸¤çº§çš„<code>Map</code>ç»“æ„ï¼Œå¤–å±‚çš„<code>KEY</code>å°±æ˜¯<code>chaincodeID</code>ï¼Œå†…å±‚çš„<code>KEY</code>å°±æ˜¯ç”¨æˆ·åœ¨è°ƒç”¨<code>PutState</code>æ–¹æ³•ä¼ å…¥çš„<code>KEY</code>ã€‚è¿™é‡Œæˆ‘ä»¬æ²¡æœ‰çœ‹åˆ°<code>channelID</code>è¿™ä¸ªç»´åº¦ï¼Œæ˜¯å› ä¸ºæ¯ä¸ª<code>channel</code>å®é™…ä¸Šéƒ½æ˜¯ç‹¬ç«‹çš„åŒºå—é“¾ï¼Œæ‰€ä»¥ä¸€ä¸ªåŒºå—ä¸­æ˜¯ä¸å¯èƒ½åŒ…å«å…¶ä»–<code>channel</code>çš„çŠ¶æ€å˜æ›´çš„ï¼Œåœ¨æœ€å<code>Batch</code>å†™å…¥çŠ¶æ€æ•°æ®åº“çš„æ—¶å€™ä¼šç»Ÿä¸€çš„æŠŠè¿™ä¸ªåŒºå—æ‰€åœ¨çš„<code>channelID</code>æ‹¼æ¥ä¸Šã€‚</p><h4 id=go-ethereumå†…å­˜ä¸­çš„çŠ¶æ€è¡¨ç¤º><code>Go-ethereum</code>å†…å­˜ä¸­çš„çŠ¶æ€è¡¨ç¤º <a href=#go-ethereum%e5%86%85%e5%ad%98%e4%b8%ad%e7%9a%84%e7%8a%b6%e6%80%81%e8%a1%a8%e7%a4%ba class=anchor>ğŸ”—</a></h4><h6 id=merkle-patricia-trieç®€ä»‹><code>MERKLE PATRICIA TRIE</code>ç®€ä»‹ <a href=#merkle-patricia-trie%e7%ae%80%e4%bb%8b class=anchor>ğŸ”—</a></h6><p>åœ¨<code>MPT</code>ä¸­æœ‰ä¸‰ç§<code>node</code>ç±»å‹(ä¸è€ƒè™‘<code>NULL</code>èŠ‚ç‚¹)</p><ul><li>Branch â€“ a 17-item node [ğ‘–0,ğ‘–1, &mldr;,ğ‘–15, ğ‘£ğ‘ğ‘™ğ‘¢ğ‘’]</li><li>Extension â€“ A 2-item node [ğ‘ğ‘ğ‘¡â„, ğ‘˜ğ‘’ğ‘¦]</li><li>Leaf â€“ A 2-item node [ğ‘ğ‘ğ‘¡â„, ğ‘£ğ‘ğ‘™ğ‘¢ğ‘’]</li></ul><blockquote><p>The Branch node is used where branching takes place, i.e. keys at certain character position starts to differ. First 16
items are used for branching, which means that this node allows for 16 possible branches for 0 â€² ğ¹ hex character. This
concept is familiar from the Memory Trie structures, where branching was constructed as a column in a table. The
ğ‘–âˆ€position contains a link to a child node whenever the child exists, i.e. this position corresponds with a next character
(hex 0 â€² ğ¹ ) in a key. The 17th item stores a value and it is used only if this node is terminating (for a certain key).</p></blockquote><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>Branch</code>èŠ‚ç‚¹çš„å‰16ä¸ª<code>item</code>ä¼šå­˜å‚¨<code>child node</code>çš„æŒ‡é’ˆï¼ˆå®é™…å°±æ˜¯<code>child node</code>çš„ğ‘˜ğ‘’ğ‘ğ‘ğ‘ğ‘˜ (ğ‘…ğ¿ğ‘ƒ (ğ‘›ğ‘œğ‘‘ğ‘’))ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªæŒ‡é’ˆä»çŠ¶æ€æ•°æ®åº“æˆ–è€…æ˜¯å…¨å±€ç¼“å­˜ä¸­åŠ è½½å¹¶è§£ç å¾—åˆ°<code>child node</code>å¯¹è±¡ï¼Œä»¥æ­¤ç±»æ¨æˆ‘ä»¬å¯ä»¥åœ¨å†…å­˜ä¸­é€æ­¥æ„å»ºå‡º<code>MPT</code>ï¼ˆå®é™…ä¸Šæˆ‘ä»¬åªä¼šåŠ è½½æœ¬æ¬¡åŒºå—æ‰§è¡Œè¿‡ç¨‹ä¸­æ‰€æœ‰äº¤æ˜“è¯»å†™è¿‡çš„èŠ‚ç‚¹ï¼‰ã€‚è€Œæœ€åä¸€ä¸ª<code>item</code>æ˜¯ç”¨æ¥å­˜å‚¨<code>value</code>çš„ï¼Œè¿™ä¸ª<code>value</code>å­˜å‚¨çš„ä¸æ˜¯ä¸€ä¸ªèŠ‚ç‚¹æŒ‡é’ˆè€Œæ˜¯ä¸€ä¸ªå®é™…çš„å€¼ã€‚<code>value</code>å¯ä»¥çœ‹åé¢ä¸€ä¸ªä¾‹å­ã€‚</p><blockquote><p>The Extension node is where the compression takes place. Whenever there is a part common for multiple keys, this
part is stored in this node. In other words, it prevents descending several times should it follow only one path. This
node, in other words, resembles a Patricia feature of number of bits to skip.</p></blockquote><p><code>Extension</code>çš„ä½œç”¨éå¸¸æ˜æ˜¾ï¼Œå°±æ˜¯ç”¨äºå‡å°‘<code>path</code>ä¸Šå…¬å…±å‰ç¼€çš„å­˜å‚¨ï¼Œå‹ç¼©<code>path</code>ã€‚å…¶ä¸­<code>path item</code>å­˜å‚¨çš„æ˜¯å…¬å…±å‰ç¼€ï¼Œ<code>value</code>æ˜¯å­˜å‚¨çš„æ˜¯ä¸€ä¸ªèŠ‚ç‚¹æŒ‡é’ˆï¼ŒåŒæ ·å¯ä»¥æ ¹æ®è¿™ä¸ªæŒ‡é’ˆåŠ è½½å‡ºæ–°çš„èŠ‚ç‚¹ã€‚</p><blockquote><p>The Leaf node terminates the path in the tree. It also uses a compression as it groups common suffixes for keys in
the ğ‘ğ‘ğ‘¡â„, which is a concept re-used again from Memory Trie.</p></blockquote><p><code>Leaf</code>ç”¨äºå­˜å‚¨å®é™…çš„å€¼ã€‚</p><p>ä»ä¸‹é¢è¿™ä¸ªä¾‹å­å¯ä»¥ç›´è§‚çš„çœ‹åˆ°<code>Branch node</code>ä¸­<code>value</code>å­˜å‚¨çš„æ˜¯<code>KEY</code>æ­£å¥½åŒ¹é…åˆ°<code>EXTENSION</code>å…¬å…±å‰ç¼€å¯¹åº”çš„å€¼ã€‚åŒæ—¶<code>Leaf node</code>ä¸­çš„å‰ç¼€<code>10</code>ä»£è¡¨çš„<code>path</code>æ˜¯å¶æ•°é•¿åº¦çš„å¶å­èŠ‚ç‚¹ç±»å‹ï¼ˆå…³äºå‰ç¼€çš„éƒ¨åˆ†å¯ä»¥å‚è€ƒ<a href=https://ethereum.github.io/yellowpaper/paper.pdf target=_blank rel=noopener>Yellow Paper</a>ä¸­
<code>Appendix C. Hex-Prefix Encoding</code>éƒ¨åˆ†ï¼‰ã€‚<p class=markdown-image><img src=https://i.imgur.com/Vmi1dRM.png alt></p></p><h6 id=mptçš„æ„å»º><code>MPT</code>çš„æ„å»º <a href=#mpt%e7%9a%84%e6%9e%84%e5%bb%ba class=anchor>ğŸ”—</a></h6><p><code>Go-ethereum</code>å†…å­˜ä¸­çš„çŠ¶æ€è¡¨ç¤ºå…¶å®ä¹‹å‰å·²ç»æåˆ°äº†ï¼Œå°±æ˜¯<code>World State Trie</code>å’Œ<code>Storage Trie</code>ã€‚<code>Go-ethereum</code>ä¸­çš„çŠ¶æ€å˜é‡å’ŒçŠ¶æ€æ•°æ®åº“ä¸­å­˜å‚¨çš„<code>KEY</code>å’Œ<code>VALUE</code>çœ‹èµ·æ¥ä¼¼ä¹æ²¡æœ‰æ˜æ˜¾çš„å…³è”ï¼Œç”¨æˆ·ä¸éœ€è¦è‡ªå·±å®šä¹‰<code>KEY</code>ï¼Œé‚£çŠ¶æ€å˜é‡çš„å€¼æ˜¯æ€ä¹ˆè·‘åˆ°<code>Storage Trie</code>çš„èŠ‚ç‚¹é‡Œçš„å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬ä»ä¸‹é¢è¿™å¼ æ•´ä½“çš„å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>Storage Trie</code>çš„<code>root</code>æ˜¯å­˜å‚¨åœ¨å¯¹åº”çš„<code>World State Trie</code>çš„<code>node</code>é‡Œçš„ï¼Œè€Œ<code>World State Trie</code>çš„<code>root</code>æ˜¯å­˜å‚¨åœ¨å¯¹åº”çš„<code>Block header</code>é‡Œçš„ã€‚<p class=markdown-image><img src=https://i.imgur.com/ctszYuo.png alt></p></p><p>å½“æˆ‘ä»¬æ‰§è¡Œä¸€ä¸ªæ–°çš„åŒºå—æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä»ä¸Šä¸€ä¸ªåŒºå—çš„<code>Block header</code>ä¸­å–å‡ºæœ€æ–°çš„<code>World State Trie</code>çš„<code>root</code>ï¼Œè¿™ä¸ª<code>root</code>å®é™…ä¸Šå°±æ˜¯<code>ğ‘˜ğ‘’ğ‘ğ‘ğ‘ğ‘˜ (ğ‘…ğ¿ğ‘ƒ (ğ‘›ğ‘œğ‘‘ğ‘’))</code>ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä»çŠ¶æ€æ•°æ®åº“æˆ–è€…æ˜¯å…¨å±€ç¼“å­˜ä¸­åŠ è½½å‡º<code>World State Trie</code>çš„<code>ğ‘…ğ¿ğ‘ƒ (ğ‘›ğ‘œğ‘‘ğ‘’)</code>ï¼Œè§£ç åæˆ‘ä»¬å°±å¾—åˆ°äº†å®é™…çš„<code>root node</code>å¯¹è±¡ã€‚ä»¥æ­¤ç±»æ¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä»<code>root node</code>å¼€å§‹ï¼Œé€šè¿‡èŠ‚ç‚¹ä¸­å­˜å‚¨çš„<code>child node</code>æŒ‡é’ˆï¼ŒåŠ è½½å‡ºéœ€è¦ç”¨åˆ°çš„<code>World State Trie</code>èŠ‚ç‚¹ã€‚å› ä¸º<code>World State Trie</code>çš„<code>Leaf node</code>ä¸­å­˜å‚¨çš„<code>value</code>å®é™…ä¸Šå°±æ˜¯<code>Go-ethereum</code>ä¸­çš„<code>Account</code>å¯¹è±¡ï¼Œå½“è¿™ä¸ª<code>Account</code>å¯¹è±¡å¯¹åº”çš„æ˜¯ä¸€ä¸ªåˆçº¦çš„æ—¶å€™ï¼Œå®ƒçš„<code>storageRoot</code>å­—æ®µå­˜å‚¨çš„å°±æ˜¯<code>Storage Trie</code>çš„<code>root</code>ã€‚åŒç†ï¼Œæˆ‘ä»¬å°±å¯ä»¥åŠ è½½å‡ºç”¨åˆ°çš„<code>Storage Trie</code>èŠ‚ç‚¹ã€‚</p><h6 id=world-state-trieä¸­çš„keyå’Œvalue><code>World State Trie</code>ä¸­çš„<code>KEY</code>å’Œ<code>VALUE</code> <a href=#world-state-trie%e4%b8%ad%e7%9a%84key%e5%92%8cvalue class=anchor>ğŸ”—</a></h6><p><code>World State Trie</code>ä¸­çš„<code>KEY</code>å’Œ<code>VALUE</code>å¯ä»¥æè¿°ä¸º</p><blockquote><p>ğ‘˜ğ‘’ğ‘ğ‘ğ‘ğ‘˜ (ğ‘ğ‘‘ğ‘‘ğ‘Ÿğ‘’ğ‘ ğ‘ ) â†’ ğ‘…ğ¿ğ‘ƒ (ğ´)</p></blockquote><p><code>KEY</code>çš„å€¼æ˜¯20å­—èŠ‚çš„<code>Address</code>ç”Ÿæˆ32å­—èŠ‚çš„å“ˆå¸Œï¼Œç„¶åç»è¿‡<code>HEX</code>ç¼–ç åï¼Œæ˜ å°„åˆ°<code>World State Trie</code>çš„è·¯å¾„ã€‚è€Œ<code>Leaf</code>èŠ‚ç‚¹ä¸­å­˜å‚¨çš„å€¼æ˜¯<code>ğ‘…ğ¿ğ‘ƒ (ğ´)</code>ï¼Œè¿™ä¸ª<code>A</code>å°±æ˜¯æˆ‘ä»¬å‰é¢æåˆ°çš„<code>Account</code>å¯¹è±¡ã€‚</p><p><code>Account</code>å¯¹è±¡ä¸­åŒ…å«å¦‚ä¸‹å±æ€§</p><ul><li>nonce
æ˜¯ä¸€ä¸ªè‡ªå¢çš„æ•´æ•°ï¼Œå¯¹äºå¤–éƒ¨è´¦å·ï¼Œè¿™ä¸ªå€¼ä»£è¡¨ä»è¿™ä¸ªåœ°å€å‘å‡ºè¿‡çš„äº¤æ˜“æ•°ï¼›è€Œå¯¹äºåˆçº¦è´¦å·ï¼Œè¿™ä¸ªå€¼ä»£è¡¨åˆçº¦çš„åˆ›å»ºæ¬¡æ•°ã€‚</li><li>balance
ä»£è¡¨è´¦æˆ·ä¸­çš„ä½™é¢ã€‚</li><li>storageRoot
å¤–éƒ¨è´¦æˆ·è¿™ä¸ªå€¼ä¸ºç©ºï¼Œåˆçº¦è´¦å·è¿™ä¸ªå€¼å­˜å‚¨äº†<code>Storage Trie</code>çš„æ ¹èŠ‚ç‚¹å“ˆå¸Œã€‚</li><li>codeHash
å¤–éƒ¨è´¦æˆ·è¿™ä¸ªå€¼ä¸ºç©ºï¼Œåˆçº¦è´¦å·è¿™ä¸ªå€¼å¯¹åº”åˆçº¦æºä»£ç çš„å“ˆå¸Œã€‚</li></ul><h6 id=storage-trieä¸­çš„keyå’Œvalue><code>Storage Trie</code>ä¸­çš„<code>KEY</code>å’Œ<code>VALUE</code> <a href=#storage-trie%e4%b8%ad%e7%9a%84key%e5%92%8cvalue class=anchor>ğŸ”—</a></h6><p><code>Storage Trie</code>çš„<code>KEY</code>å’Œ<code>VALUE</code>æ˜¯æœ€å¤æ‚çš„ï¼Œå› ä¸ºè¿™é‡Œå’Œ<code>Solidity</code>çš„æ•°æ®ç±»å‹å¸ƒå±€ç´§å¯†ç›¸å…³ï¼Œç”¨ä¸€ä¸ªé€šç”¨çš„æ–¹å¼æè¿°å¦‚ä¸‹</p><blockquote><p>ğ‘˜ğ‘’ğ‘ğ‘ğ‘ğ‘˜ (ğ‘–ğ‘›ğ‘‘ğ‘’ğ‘¥) â†’ ğ‘…ğ¿ğ‘ƒ (ğ‘ ğ‘™ğ‘œğ‘¡)</p></blockquote><p><code>Storage Trie</code>ä¸­çš„<code>Leaf</code>èŠ‚ç‚¹å­˜å‚¨çš„å€¼å°±æ˜¯<code>slot</code>ï¼Œè¿™ä¸ª<code>slot</code>å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªé•¿åº¦32çš„å­—èŠ‚æ•°ç»„ï¼Œè€Œ<code>index</code>å°±æ˜¯ç”¨äºå®šä½è¿™ä¸ª<code>slot</code>çš„å€¼ï¼ˆå¯èƒ½å°±æ˜¯<code>slot</code>çš„åºå·ï¼Œä¹Ÿå¯èƒ½æ˜¯(åºå·+key)ï¼‰ã€‚<code>slot</code>çš„åºå·å°±æ˜¯æ ¹æ®æˆ‘ä»¬<code>Solidity</code>ä»£ç ä¸­å®šä¹‰çš„<code>State Variables</code>çš„é¡ºåºäº§ç”Ÿã€‚</p><p><code>KEY</code>çš„å®é™…å€¼å°±æ˜¯<code>index</code>çš„å“ˆå¸Œï¼Œç„¶åç»è¿‡<code>HEX</code>ç¼–ç åï¼Œæˆ‘ä»¬å°±èƒ½å°†<code>KEY</code>æ˜ å°„æˆ<code>Storage Trie</code>çš„<code>path</code>ï¼Œç„¶åå°†<code>slot</code>å­˜å‚¨åˆ°<code>Storage Trie</code>çš„<code>Leaf</code>èŠ‚ç‚¹ä¸­ã€‚</p><p>ä¸‹é¢çœ‹çœ‹ä¸åŒç±»å‹çš„<code>slot</code>çš„ä¾‹å­ï¼Œæ›´è¯¦ç»†çš„æè¿°è¯·å‚è€ƒ<code>Solidity</code>å®˜æ–¹æ–‡æ¡£<a href=https://docs.soliditylang.org/en/v0.8.17/internals/layout_in_storage.html target=_blank rel=noopener>layout_in_storage</a>ç« èŠ‚ã€‚</p><ul><li>Statically Sized Variables<p class=markdown-image><img src=https://i.imgur.com/4PgJlD4.png alt></p></li></ul><p>å®šé•¿ç±»å‹çš„å˜é‡ä¼šæ ¹æ®ç±»å‹é•¿åº¦ï¼Œå¤šä¸ªå˜é‡å…±äº«æˆ–è€…å•ä¸ªå˜é‡ç‹¬å ä¸€ä¸ª<code>slot</code>ã€‚</p><ul><li>Maps<p class=markdown-image><img src=https://i.imgur.com/Zvl7wiT.png alt></p></li></ul><p><code>Map</code>çš„<code>index</code>åŒ…å«äº†ç”¨æˆ·<code>key</code>ï¼Œä»è¿™ä¸ªå¸ƒå±€ä¸­æˆ‘ä»¬å°±èƒ½çœ‹åˆ°å®é™…ä¸Šå¹¶æ²¡æœ‰å­˜å‚¨ç”¨æˆ·<code>key</code>çš„åŸå€¼ï¼ŒåŒæ—¶ä¹Ÿæ²¡æœ‰å­˜å‚¨<code>Map</code>çš„<code>size</code>ï¼Œæ‰€æœ‰æˆ‘ä»¬åœ¨<code>Solidity</code>ä¸­ä¸èƒ½ç›´æ¥è¿­ä»£<code>mapping</code>ã€‚</p><ul><li>Dynamic Arrays<p class=markdown-image><img src=https://i.imgur.com/igt0gMm.png alt></p></li></ul><p>åŠ¨æ€æ•°ç»„çš„<code>index</code>åŒ…å«äº†æ•°ç»„ä¸­çš„ä½ç½®ï¼ŒåŒæ—¶è¿˜å­˜å‚¨äº†æ•°ç»„çš„<code>size</code>ã€‚</p><ul><li>Byte Arrays and String<p class=markdown-image><img src=https://i.imgur.com/aBB0JJL.png alt></p></li></ul><p>å¯¹äºå­—èŠ‚æ•°ç»„å’Œå­—ç¬¦ä¸²ï¼Œå¦‚æœé•¿åº¦å°äº32ï¼Œå°±ç”¨ä¸€ä¸ª<code>slot</code>å­˜å‚¨ï¼ŒåŒæ—¶æœ€åä¸€ä¸ªå­—èŠ‚å­˜å‚¨å®é™…é•¿åº¦ã€‚å¦‚æœé•¿åº¦æ›´é•¿ï¼Œåˆ™ä½¿ç”¨å’ŒåŠ¨æ€æ•°ç»„ä¸€æ ·çš„æ–¹å¼å­˜å‚¨ã€‚</p><h6 id=mptçš„æäº¤><code>MPT</code>çš„æäº¤ <a href=#mpt%e7%9a%84%e6%8f%90%e4%ba%a4 class=anchor>ğŸ”—</a></h6><p>åœ¨åŒºå—æ‰€æœ‰äº¤æ˜“æ‰§è¡Œå®Œæˆåï¼Œæ‰€æœ‰æˆåŠŸæ‰§è¡Œçš„äº¤æ˜“å¯¼è‡´å˜åŒ–è¿‡çš„<code>MPT</code>èŠ‚ç‚¹ï¼Œæœ€åä¼šç»Ÿä¸€æ›´æ–°åˆ°çŠ¶æ€æ•°æ®åº“å’Œå…¨å±€ç¼“å­˜ã€‚æ ¹æ®<code>Ethereum</code>æ•°æ®åº“ä¸­çš„<code>KEY</code>å’Œ<code>VALUE</code>çš„å†…å®¹ï¼Œæˆ‘ä»¬çŸ¥é“äº†å¯¹äºåº•å±‚æ•°æ®åº“æ¥è¯´å®é™…åªä¼šæ–°æ’å…¥æ•°æ®ï¼ˆçŠ¶æ€è†¨èƒ€é—®é¢˜ï¼‰ã€‚åŒæ—¶æˆ‘ä»¬è¿˜è¦æ³¨æ„ï¼Œå› ä¸º<code>Leaf</code>ä¸­çš„å€¼æ”¹å˜äº†ï¼Œå¯¼è‡´<code>Leaf</code>èŠ‚ç‚¹å†…å®¹å˜åŒ–äº†ï¼Œ<code>Leaf</code>èŠ‚ç‚¹çš„<code>hash</code>ä¹Ÿå˜åŒ–äº†ï¼Œæ„å‘³ç€<code>Branch</code>èŠ‚ç‚¹ä¸­çš„èŠ‚ç‚¹æŒ‡é’ˆä¹Ÿå˜åŒ–äº†ï¼Œæ‰€ä»¥<code>Branch</code>èŠ‚ç‚¹çš„å†…å®¹å®é™…ä¹Ÿå˜åŒ–äº†ï¼Œä»¥æ­¤ç±»æ¨ï¼Œä¸€ç›´ä¼šå¾—åˆ°ä¸€ä¸ªå˜åŒ–äº†çš„<code>root</code>ã€‚è¿™ä¸ªæ­£æ˜¯<code>MPT</code>ç»“æ„ä¸­<code>Merkle tree</code>çš„ä½“ç°ï¼Œåˆ©ç”¨è¿™ä¸ªæ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>Merkle proof</code>æ¥è¯æ˜<code>MPT</code>èŠ‚ç‚¹çš„å­˜åœ¨æ€§ã€‚æ‰€ä»¥<code>MPT</code>æ˜¯ä¸€ç§<code>Authenticated Storage</code>ï¼Œå¯¹äºæ‹¥æœ‰<code>Light client</code>çš„é“¾æ¥è¯´ï¼Œæ˜¯ä¸€ç§å¿…è¦çš„å±æ€§ã€‚</p><h2 id=ç»“è¯­>ç»“è¯­ <a href=#%e7%bb%93%e8%af%ad class=anchor>ğŸ”—</a></h2><p>éšç€<code>Fabric</code>å’Œ<code>Go-ethereum</code>çš„ä¸æ–­æ›´æ–°è¿­ä»£ï¼Œä¸Šè¿°å†…å®¹å¯èƒ½ä¼šè¿‡æ—¶ï¼Œä½†æ˜¯ä¸å¦¨ç¢æˆ‘ä»¬äº†è§£åˆ°åŒºå—é“¾ä¸­å¯¹äºçŠ¶æ€ç®¡ç†çš„æ•´ä½“çš„è®¾è®¡æ€è·¯ã€‚å®é™…ä¸Šé’ˆå¯¹çŠ¶æ€è†¨èƒ€é—®é¢˜<code>Go-ethereum</code>å·²ç»åœ¨ä»<code>hash-based state scheme</code>åˆ‡æ¢åˆ°<a href=https://github.com/ethereum/go-ethereum/issues/25390 target=_blank rel=noopener><code>path-based state scheme</code></a>ï¼Œè€Œå¦ä¸€ä¸ªæ•°æ®ç»“æ„<a href=https://blog.ethereum.org/2021/12/02/verkle-tree-structure target=_blank rel=noopener>Verkle trie</a>å°†å¾ˆå¯èƒ½æ›¿æ¢<code>MPT</code>ç”¨äºè§£å†³<code>proof size</code>è¿‡å¤§çš„é—®é¢˜ã€‚æœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥è‡ªè¡Œäº†è§£ã€‚</p><p>çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªé¡¹ç›®<a href=https://github.com/GrapeBaBa/verkle target=_blank rel=noopener>verkle</a>ç”¨æ¥å­¦ä¹ <code>verkle trie</code>ï¼Œä¸»è¦å‚è€ƒ<a href=https://github.com/gballet/go-verkle target=_blank rel=noopener>go-verkle</a>ã€‚ç›®å‰ä»£ç åªå®ç°äº†å¾ˆå°‘çš„ä¸€éƒ¨åˆ†ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥ä¸€èµ·æ¥åŠ¨åŠ¨æ‰‹ã€‚</p></div><div class=tags><a href=https://grapebaba.github.io/tags/blockchain>Blockchain</a>
<a href=https://grapebaba.github.io/tags/hyperledger-fabric>Hyperledger fabric</a>
<a href=https://grapebaba.github.io/tags/ethereum>Ethereum</a>
<a href=https://grapebaba.github.io/tags/merkle-patricia-trie>Merkle Patricia Trie</a></div><div id=comment><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//grapebaba.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></section></main><footer id=footer><div id=social><a class=symbol href=https://github.com/GrapeBaBa rel=me target=_blank><svg fill="#bbb" width="28" height="28" viewBox="0 0 72 72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Github</title><desc>Created with Sketch.</desc><defs/><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Social-Icons---Rounded-Black" transform="translate(-264.000000, -939.000000)"><g id="Github" transform="translate(264.000000, 939.000000)"><path d="M8 72H64c4.418278.0 8-3.581722 8-8V8c0-4.418278-3.581722-8-8-8H8c-4.418278 811624501e-24-8 3.581722-8 8V64c541083001e-24 4.418278 3.581722 8 8 8z" id="Rounded" fill="#bbb"/><path d="M35.9985 13C22.746 13 12 23.7870921 12 37.096644c0 10.6440272 6.876 19.6751861 16.4145 22.8617681C29.6145 60.1797862 30.0525 59.4358488 30.0525 58.7973276 30.0525 58.2250681 30.0315 56.7100863 30.0195 54.6996482c-6.6765 1.4562499-8.085-3.2302544-8.085-3.2302544-1.0905-2.7829884-2.664-3.5239139-2.664-3.5239139C17.091 46.4500754 19.4355 46.4801943 19.4355 46.4801943c2.4075.1701719 3.675 2.4833051 3.675 2.4833051 2.142 3.6820383 5.6175 2.6188404 6.9855 2.0014024C30.3135 49.4077535 30.9345 48.3460615 31.62 47.7436831 26.2905 47.1352808 20.688 45.0691228 20.688 35.8361671c0-2.6308879.9345-4.781379 2.4705-6.4665327C22.911 28.7597262 22.0875 26.3110578 23.3925 22.9934585c0 0 2.016-.6475568 6.6 2.4697516C31.908 24.9285993 33.96 24.6620468 36.0015 24.6515052 38.04 24.6620468 40.0935 24.9285993 42.0105 25.4632101c4.581-3.1173084 6.5925-2.4697516 6.5925-2.4697516C49.9125 26.3110578 49.089 28.7597262 48.8415 29.3696344 50.3805 31.0547881 51.309 33.2052792 51.309 35.8361671c0 9.2555448-5.6115 11.29309-10.9575 11.8894446.860999999999997.7439374 1.629 2.2137408 1.629 4.4621184C41.9805 55.4089489 41.9505 58.0067059 41.9505 58.7973276 41.9505 59.4418726 42.3825 60.1918338 43.6005 59.9554002 53.13 56.7627944 60 47.7376593 60 37.096644 60 23.7870921 49.254 13 35.9985 13" fill="#fff"/></g></g></g></svg></a><a class=symbol href=https://stackoverflow.com/users/3141951/grapebaba rel=me target=_blank><svg fill="#bbb" width="28" height="28" viewBox="0 0 72 72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>stackoverflow</title><desc>Created with Sketch.</desc><defs/><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Social-Icons---Rounded-Black" transform="translate(-488.000000, -1163.000000)"><g id="stackoverflow" transform="translate(488.000000, 1163.000000)"><path d="M8 72H64c4.418278.0 8-3.581722 8-8V8c0-4.418278-3.581722-8-8-8H8c-4.418278 811624501e-24-8 3.581722-8 8V64c541083001e-24 4.418278 3.581722 8 8 8z" id="Rounded" fill="#bbb"/><path d="M42.0860128 53.5922927 22.9745951 53.6011499 22.9729497 49.5538824 42.0835447 49.5440929 42.0860128 53.5922927zM55 30.6708298 51.7306912 12 47.7087256 12.6920259l3.2688387 18.6708298L55 30.6708298zM42.5455518 44.3547147 23.5156994 42.616026 23.1410164 46.6470941l19.030205 1.7370572L42.5455518 44.3547147zm1.2554466-5.2815628-18.4550173-4.919234L24.285633 38.0621508l18.4563101 4.9198168 1.0590553-3.9088157zm2.4093479-4.6295108-16.4608999-9.6271776-2.0746249 3.4850693 16.4617226 9.6277603 2.0738022-3.485652zm4.0363041-2.8347655-3.3721468 2.2794433L36.106599 18.2318456l3.3726169-2.2801425L50.2466504 31.6088756zm-4.9150697 8.6695527h3.2483886V60H17V40.2784283h3.2648427V56.8243495h25.066738V40.2784283z" fill="#fff"/></g></g></g></svg></a><a class=symbol href=https://twitter.com/GrapeBaBa rel=me target=_blank><svg fill="#bbb" width="28" height="28" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="438.536" height="438.536" viewBox="0 0 438.536 438.536" style="enable-background:new 0 0 438.536 438.536"><g><path d="M414.41 24.123C398.333 8.042 378.963.0 356.315.0H82.228C59.58.0 40.21 8.042 24.126 24.123 8.045 40.207.003 59.576.003 82.225v274.084c0 22.647 8.042 42.018 24.123 58.102 16.084 16.084 35.454 24.126 58.102 24.126h274.084c22.648.0 42.018-8.042 58.095-24.126 16.084-16.084 24.126-35.454 24.126-58.102V82.225C438.532 59.576 430.49 40.204 414.41 24.123zM335.471 168.735c.191 1.713.288 4.278.288 7.71.0 15.989-2.334 32.025-6.995 48.104-4.661 16.087-11.8 31.504-21.416 46.254-9.606 14.749-21.074 27.791-34.396 39.115-13.325 11.32-29.311 20.365-47.968 27.117-18.648 6.762-38.637 10.143-59.953 10.143-33.116.0-63.76-8.952-91.931-26.836 4.568.568 9.329.855 14.275.855 27.6.0 52.439-8.565 74.519-25.7-12.941-.185-24.506-4.179-34.688-11.991-10.185-7.803-17.273-17.699-21.271-29.691 4.947.76 8.658 1.137 11.132 1.137 4.187.0 9.042-.76 14.56-2.279-13.894-2.669-25.598-9.562-35.115-20.697-9.519-11.136-14.277-23.84-14.277-38.114v-.571c10.085 4.755 19.602 7.229 28.549 7.422-17.321-11.613-25.981-28.265-25.981-49.963.0-10.66 2.758-20.747 8.278-30.264 15.035 18.464 33.311 33.213 54.816 44.252 21.507 11.038 44.54 17.227 69.092 18.558-.95-3.616-1.427-8.186-1.427-13.704.0-16.562 5.853-30.692 17.56-42.399 11.703-11.706 25.837-17.561 42.394-17.561 17.515.0 32.079 6.283 43.688 18.846 13.134-2.474 25.892-7.33 38.26-14.56-4.757 14.652-13.613 25.788-26.55 33.402 12.368-1.716 23.88-4.95 34.537-9.708C357.458 149.793 347.462 160.166 335.471 168.735z"/></g></svg></a></div><div class=copyright>Â© Copyright
2023
<span class=split><svg fill="#bbb" width="15" height="15" id="heart-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15"><path d="M13.91 6.75c-1.17 2.25-4.3 5.31-6.07 6.94-.1903.1718-.4797.1718-.67.0C5.39 12.06 2.26 9 1.09 6.75-1.48 1.8 5-1.5 7.5 3.45 10-1.5 16.48 1.8 13.91 6.75z"/></svg></span>Grapebaba</div><div class=powerby>Powered by <a href=http://www.gohugo.io/>Hugo</a> Theme By <a href=https://github.com/nodejh/hugo-theme-mini>nodejh</a></div></footer></body></html>